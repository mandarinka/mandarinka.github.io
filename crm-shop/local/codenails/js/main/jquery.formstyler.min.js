/**
 * jquery-formstyler-modern - JQuery HTML form styling plugin
 * Кастомная сборка без чекбоксов и радиокнопок
 * 
 * @version   v1.1.9-custom
 * @date 17.02.2016
 * 
 * @link https://github.com/ange007/JQueryFormStyler-Modern
 * @license    MIT
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){"use strict";function t(t,s){this.element=t,this.options=e.extend({},a,s),this.init()}function s(t){if(!e(t.target).parents().hasClass(""+l+"selectbox")&&"OPTION"!==t.target.nodeName&&e("div."+l+"selectbox.opened").length){var s=e("div."+l+"selectbox.opened"),o=e("div."+l+"selectbox__search input",s),a=e("div."+l+"selectbox__dropdown",s),d=s.find("select").data("_"+i).options;d.onSelectClosed.call(s),o.length&&o.val("").keyup(),a.hide().find("li.sel").addClass("selected"),s.removeClass("focused opened dropup dropdown")}}var i="styler",o="-"+i,l="jq-",a={wrapper:"form",filePlaceholder:"Файл не выбран",fileBrowse:"Обзор...",fileNumber:"Выбрано файлов: %s",selectPlaceholder:"Выберите...",selectSearch:!1,selectSearchLimit:10,selectSearchNotFound:"Совпадений не найдено",selectSearchPlaceholder:"Поиск...",selectVisibleOptions:0,singleSelectzIndex:"100",selectSmartPositioning:!0,checkboxIndeterminate:!1,onSelectOpened:function(){},onSelectClosed:function(){},onFormStyled:function(){}};t.prototype={init:function(){function t(){var e="",t="",s="",l="";void 0!==a.attr("id")&&""!==a.attr("id")&&(e=' id="'+a.attr("id")+o+'"'),void 0!==a.attr("title")&&""!==a.attr("title")&&(t=' title="'+a.attr("title")+'"'),void 0!==a.attr("class")&&""!==a.attr("class")&&(s=" "+a.attr("class"));var d=a.data();for(var n in d)""!==d[n]&&n!=="_"+i&&(l+=" data-"+n+'="'+d[n]+'"');e+=l,this.id=e,this.title=t,this.classes=s}var a=e(this.element),d=this.options,n=navigator.userAgent.match(/(iPad|iPhone|iPod)/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?!0:!1,r=navigator.userAgent.match(/Android/i)&&!navigator.userAgent.match(/(Windows\sPhone)/i)?!0:!1;if(a.is(":file")){a.css({position:"absolute",top:0,right:0,width:"100%",height:"100%",opacity:0,margin:0,padding:0});var c=function(){var s=new t,o=a.data("placeholder"),n=a.data("browse");void 0===o&&(o=d.filePlaceholder),(void 0===n||""===n)&&(n=d.fileBrowse);var r=e("<div"+s.id+' class="'+l+"file"+s.classes+'"'+s.title+' style="display: inline-block; position: relative; overflow: hidden"></div>'),c=e('<div class="'+l+'file__name">'+o+"</div>").appendTo(r);e('<div class="'+l+'file__browse">'+n+"</div>").appendTo(r),a.after(r).appendTo(r),a.is(":disabled")&&r.addClass("disabled"),a.on("change."+i,function(){var e=a.val();if(a.is("[multiple]")){var t=a[0].files.length;if(e="",t>0){var s=a.data("number");void 0===s&&(s=d.fileNumber),s=s.replace("%s",t),e=s}}c.text(e.replace(/.+[\\\/]/,"")),""===e?(c.text(o),r.removeClass("changed")):r.addClass("changed")}).on("focus."+i,function(){r.addClass("focused")}).on("blur."+i,function(){r.removeClass("focused")}).on("click."+i,function(){r.removeClass("focused")}),a.change()};c(),a.on("refresh",function(){a.off("."+i).parent().before(a).remove(),c()})}else if(a.is('input[type="number"]')){var h=function(){var t,s,o,d=e('<div class="'+l+'number"><div class="'+l+'number__spin minus"></div><div class="'+l+'number__spin plus"></div></div>'),n=null,r=null;a.after(d).prependTo(d).wrap('<div class="'+l+'number__field"></div>'),a.is(":disabled")&&d.addClass("disabled"),void 0!==a.attr("min")&&(t=a.attr("min")),void 0!==a.attr("max")&&(s=a.attr("max")),o=Number(void 0!==a.attr("step")&&e.isNumeric(a.attr("step"))?a.attr("step"):1);var c=function(i){var l,d=a.val();e.isNumeric(d)||(d=0,a.val("0")),i.is(".minus")?(l=parseInt(d,10)-o,o>0&&(l=Math.ceil(l/o)*o)):i.is(".plus")&&(l=parseInt(d,10)+o,o>0&&(l=Math.floor(l/o)*o)),e.isNumeric(t)&&e.isNumeric(s)?l>=t&&s>=l&&a.val(l):e.isNumeric(t)&&!e.isNumeric(s)?l>=t&&a.val(l):!e.isNumeric(t)&&e.isNumeric(s)?s>=l&&a.val(l):a.val(l)};d.is(".disabled")||(d.on("mousedown","div."+l+"number__spin",function(){var t=e(this);c(t),n=setTimeout(function(){r=setInterval(function(){c(t)},40)},350)}).on("mouseup mouseout","div."+l+"number__spin",function(){clearTimeout(n),clearInterval(r)}),a.on("focus."+i,function(){d.addClass("focused")}).on("blur."+i,function(){d.removeClass("focused")})),a.change()};h(),a.on("refresh",function(){a.off("."+i).closest("."+l+"number").before(a).remove(),h()})}else if(a.is("select")){var p=function(){function c(t){t.off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(t){var s=null;"mousewheel"===t.type?s=-1*t.originalEvent.wheelDelta:"DOMMouseScroll"===t.type&&(s=40*t.originalEvent.detail),s&&(t.stopPropagation(),t.preventDefault(),e(this).scrollTop(s+e(this).scrollTop()))})}function h(){for(var e=0;e<u.length;e++){var t=u.eq(e),s="",i="",l="",a="",d="",n="",r="",c="",h="",p="disabled",f="selected sel disabled";t.prop("selected")&&(i="selected sel"),t.is(":disabled")&&(i=p),t.is(":selected:disabled")&&(i=f),void 0!==t.attr("id")&&""!==t.attr("id")&&(a=' id="'+t.attr("id")+o+'"'),void 0!==t.attr("title")&&""!==u.attr("title")&&(d=' title="'+t.attr("title")+'"'),void 0!==t.attr("class")&&(r=" "+t.attr("class"),h=' data-jqfs-class="'+t.attr("class")+'"');var m=t.data();for(var g in m)""!==m[g]&&(n+=" data-"+g+'="'+m[g]+'"');i+r!==""&&(l=' class="'+i+r+'"'),s="<li"+h+n+l+d+a+">"+t.html()+"</li>",t.parent().is("optgroup")&&(void 0!==t.parent().attr("class")&&(c=" "+t.parent().attr("class")),s="<li"+h+n+' class="'+i+r+" option"+c+'"'+d+a+">"+t.html()+"</li>",t.is(":first-child")&&(s='<li class="optgroup'+c+'">'+t.parent().attr("label")+"</li>"+s)),v+=s}}function p(){var o=new t,p="",f=a.data("placeholder"),m=a.data("search"),g=a.data("search-limit"),b=a.data("search-not-found"),x=a.data("search-placeholder"),w=a.data("z-index"),C=a.data("smart-positioning");void 0===f&&(f=d.selectPlaceholder),(void 0===m||""===m)&&(m=d.selectSearch),(void 0===g||""===g)&&(g=d.selectSearchLimit),(void 0===b||""===b)&&(b=d.selectSearchNotFound),void 0===x&&(x=d.selectSearchPlaceholder),(void 0===w||""===w)&&(w=d.singleSelectzIndex),(void 0===C||""===C)&&(C=d.selectSmartPositioning);var y=e("<div"+o.id+' class="'+l+"selectbox jqselect"+o.classes+'" style="display: inline-block; position: relative; z-index:'+w+'"><div class="'+l+'selectbox__select"'+o.title+' style="position: relative"><div class="'+l+'selectbox__select-text"></div><div class="'+l+'selectbox__trigger"><div class="'+l+'selectbox__trigger-arrow"></div></div></div></div>');a.css({margin:0,padding:0}).after(y).prependTo(y);var _=e("div."+l+"selectbox__select",y),T=e("div."+l+"selectbox__select-text",y),S=u.filter(":selected");h(),m&&(p='<div class="'+l+'selectbox__search"><input type="search" autocomplete="off" placeholder="'+x+'"></div><div class="'+l+'selectbox__not-found">'+b+"</div>");var q=e('<div class="'+l+'selectbox__dropdown" style="position: absolute">'+p+'<ul style="position: relative; list-style: none; overflow: auto; overflow-x: hidden">'+v+"</ul></div>");y.append(q);var k=e("ul",q),j=e("li",q),A=e("input",q),N=e("div."+l+"selectbox__not-found",q).hide();j.length<g&&A.parent().hide(),""===S.text()?T.text(f).addClass("placeholder"):T.text(S.text());var P=0,I=0;if(j.css({display:"inline-block"}),j.each(function(){var t=e(this);t.innerWidth()>P&&(P=t.innerWidth(),I=t.width())}),j.css({display:""}),T.is(".placeholder")&&T.width()>P)T.width(T.width());else{var H=y.clone().appendTo("body").width("auto"),M=H.outerWidth();H.remove(),M===y.outerWidth()&&T.width(I)}P>y.width()&&q.width(P),""===u.first().text()&&""!==a.data("placeholder")&&j.first().hide(),a.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0});var K=y.outerHeight(!0),O=A.parent().outerHeight(!0),z=k.css("max-height"),D=j.filter(".selected"),W=q.css("top");if(D.length<1&&j.first().addClass("selected sel"),void 0===j.data("li-height")&&j.data("li-height",j.outerHeight()),"auto"===q.css("left")&&q.css({left:0}),"auto"===q.css("top")&&q.css({top:K}),q.hide(),D.length&&(u.first().text()!==S.text()&&y.addClass("changed"),y.data("jqfs-class",D.data("jqfs-class")),y.addClass(D.data("jqfs-class"))),a.is(":disabled"))return y.addClass("disabled"),!1;_.click(function(){if(e("div."+l+"selectbox").filter(".opened").length&&d.onSelectClosed.call(e("div."+l+"selectbox").filter(".opened")),a.focus(),!r&&!n){var t=e(window),s=j.data("li-height"),i=y.offset().top,o=t.height()-K-(i-t.scrollTop()),h=a.data("visible-options"),p=5*s,f=s*h;(void 0===h||""===h)&&(h=d.selectVisibleOptions),h>0&&6>h&&(p=f),0===h&&(f="auto");var v=function(){var e=function(){k.css("max-height",Math.floor((o-20-O)/s)*s)};q.height("auto").css({bottom:"auto",top:W}),e(),k.css("max-height",f),"none"!==z&&k.css("max-height",z),o<q.outerHeight()+20&&e()},m=function(){var e=function(){k.css("max-height",Math.floor((i-t.scrollTop()-20-O)/s)*s)};q.height("auto").css({top:"auto",bottom:W}),e(),k.css("max-height",f),"none"!==z&&k.css("max-height",z),i-t.scrollTop()-20<q.outerHeight()+20&&e()};C===!0||1===C?o>p+O+20?(v(),y.removeClass("dropup").addClass("dropdown")):(m(),y.removeClass("dropdown").addClass("dropup")):(C===!1||0===C)&&o>p+O+20&&(v(),y.removeClass("dropup").addClass("dropdown")),y.offset().left+q.outerWidth()>t.width()&&q.css({left:"auto",right:0}),e("div.jqselect").css({zIndex:w-1}).removeClass("opened"),y.css({zIndex:w}),q.is(":hidden")?(e("div."+l+"selectbox__dropdown:visible").hide(),q.show(),y.addClass("opened focused"),d.onSelectOpened.call(y)):(q.hide(),y.removeClass("opened dropup dropdown"),e("div."+l+"selectbox").filter(".opened").length&&d.onSelectClosed.call(y)),A.length&&(A.val("").keyup(),N.hide(),A.keyup(function(){var t=e(this).val();j.each(function(){e(this).html().match(new RegExp(".*?"+t+".*?","i"))?e(this).show():e(this).hide()}),""===u.first().text()&&""!==a.data("placeholder")&&j.first().hide(),j.filter(":visible").length<1?N.show():N.hide()})),j.filter(".selected").length&&(""===a.val()?k.scrollTop(0):(k.innerHeight()/s%2!==0&&(s/=2),k.scrollTop(k.scrollTop()+j.filter(".selected").position().top-k.innerHeight()/2+s))),c(k)}}),j.hover(function(){e(this).siblings().removeClass("selected")});var F=j.filter(".selected").text();j.filter(":not(.disabled):not(.optgroup)").click(function(){var t=e(this),s=t.text();if(a.focus(),!t.is(".selected")){var i=t.index();i-=t.prevAll(".optgroup").length,t.addClass("selected sel").siblings().removeClass("selected sel"),u.prop("selected",!1).eq(i).prop("selected",!0),F=s,T.text(s),y.data("jqfs-class")&&y.removeClass(y.data("jqfs-class")),y.data("jqfs-class",t.data("jqfs-class")),y.addClass(t.data("jqfs-class")),a.change()}q.hide(),y.removeClass("opened dropup dropdown"),d.onSelectClosed.call(y)}),q.mouseout(function(){e("li.sel",q).addClass("selected")}),a.on("change."+i,function(){T.text(u.filter(":selected").text()).removeClass("placeholder"),j.removeClass("selected sel").not(".optgroup").eq(a[0].selectedIndex).addClass("selected sel"),u.first().text()!==j.filter(".selected").text()?y.addClass("changed"):y.removeClass("changed")}).on("focus."+i,function(){y.addClass("focused"),e("div.jqselect").not(".focused").removeClass("opened dropup dropdown").find("div."+l+"selectbox__dropdown").hide()}).on("blur."+i,function(){y.removeClass("focused")}).on("keydown."+i+" keyup."+i,function(e){var t=j.data("li-height");""===a.val()?T.text(f).addClass("placeholder"):T.text(u.filter(":selected").text()),j.removeClass("selected sel").not(".optgroup").eq(a[0].selectedIndex).addClass("selected sel"),(38===e.which||37===e.which||33===e.which||36===e.which)&&k.scrollTop(""===a.val()?0:k.scrollTop()+j.filter(".selected").position().top),(40===e.which||39===e.which||34===e.which||35===e.which)&&k.scrollTop(k.scrollTop()+j.filter(".selected").position().top-k.innerHeight()+t),13===e.which&&(e.preventDefault(),q.hide(),y.removeClass("opened dropup dropdown"),d.onSelectClosed.call(y))}).on("keydown."+i,function(e){32===e.which&&(e.preventDefault(),_.click())}),s.registered||(e(document).on("click",s),s.registered=!0)}function f(){var s=new t,o=e("<div"+s.id+' class="'+l+"select-multiple jqselect"+s.classes+'"'+s.title+' style="display: inline-block; position: relative"></div>');a.css({margin:0,padding:0}).after(o),h(),o.append("<ul>"+v+"</ul>");var d=e("ul",o).css({position:"relative","overflow-x":"hidden","-webkit-overflow-scrolling":"touch"}),n=e("li",o).attr("unselectable","on"),r=a.attr("size"),p=d.outerHeight(),f=n.outerHeight();d.css(void 0!==r&&r>0?{height:f*r}:{height:4*f}),p>o.height()&&(d.css("overflowY","scroll"),c(d),n.filter(".selected").length&&d.scrollTop(d.scrollTop()+n.filter(".selected").position().top)),a.prependTo(o).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0}),a.is(":disabled")?(o.addClass("disabled"),u.each(function(){e(this).is(":selected")&&n.eq(e(this).index()).addClass("selected")})):(n.filter(":not(.disabled):not(.optgroup)").click(function(t){a.focus();var s=e(this);if(t.ctrlKey||t.metaKey||s.addClass("selected"),t.shiftKey||s.addClass("first"),t.ctrlKey||t.metaKey||t.shiftKey||s.siblings().removeClass("selected first"),(t.ctrlKey||t.metaKey)&&(s.is(".selected")?s.removeClass("selected first"):s.addClass("selected first"),s.siblings().removeClass("first")),t.shiftKey){var i=!1,o=!1;s.siblings().removeClass("selected").siblings(".first").addClass("selected"),s.prevAll().each(function(){e(this).is(".first")&&(i=!0)}),s.nextAll().each(function(){e(this).is(".first")&&(o=!0)}),i&&s.prevAll().each(function(){return e(this).is(".selected")?!1:void e(this).not(".disabled, .optgroup").addClass("selected")}),o&&s.nextAll().each(function(){return e(this).is(".selected")?!1:void e(this).not(".disabled, .optgroup").addClass("selected")}),1===n.filter(".selected").length&&s.addClass("first")}u.prop("selected",!1),n.filter(".selected").each(function(){var t=e(this),s=t.index();t.is(".option")&&(s-=t.prevAll(".optgroup").length),u.eq(s).prop("selected",!0)}),a.change()}),u.each(function(t){e(this).data("optionIndex",t)}),a.on("change."+i,function(){n.removeClass("selected");var t=[];u.filter(":selected").each(function(){t.push(e(this).data("optionIndex"))}),n.not(".optgroup").filter(function(s){return e.inArray(s,t)>-1}).addClass("selected")}).on("focus."+i,function(){o.addClass("focused")}).on("blur."+i,function(){o.removeClass("focused")}),p>o.height()&&a.on("keydown."+i,function(e){(38===e.which||37===e.which||33===e.which)&&d.scrollTop(d.scrollTop()+n.filter(".selected").position().top-f),(40===e.which||39===e.which||34===e.which)&&d.scrollTop(d.scrollTop()+n.filter(".selected:last").position().top-d.innerHeight()+2*f)}))}var u=e("option",a),v="";if(a.is("[multiple]")){if(r||n)return;f()}else p()};p(),a.on("refresh",function(){a.off("."+i).parent().before(a).remove(),p()})}else{if(a.is('input[type="hidden"]'))return!1;a.is("input")?a.addClass(i):a.is(":reset")&&a.on("click",function(){setTimeout(function(){a.closest(d.wrapper).find("input, select").trigger("refresh")},1)})}},destroy:function(t){var s=e(this.element);t||s.removeData("_"+i),s.is(":checkbox")||s.is(":radio")?(s.off("."+i+" refresh").removeAttr("style").parent().before(s).remove(),s.closest("label").add('label[for="'+s.attr("id")+'"]').off("."+i)):s.is('input[type="number"]')?s.off("."+i+" refresh").closest("."+l+"number").before(s).remove():(s.is(":file")||s.is("select"))&&s.off("."+i+" refresh").removeAttr("style").parent().before(s).remove()},reinitialize:function(t){this.destroy(!0),this.options=e.extend({},a,t),this.init()}},e.fn[i]=function(s){var o=arguments;if(void 0===s||"object"==typeof s)return this.each(function(){e.data(this,"_"+i)||e.data(this,"_"+i,new t(this,s))}).promise().done(function(){var t=e(this[0]).data("_"+i);t&&t.options.onFormStyled.call()}),this;if("string"==typeof s&&"_"!==s[0]&&"init"!==s){var l;return this.each(function(){var a=e.data(this,"_"+i);a instanceof t&&"function"==typeof a[s]&&(l=a[s].apply(a,Array.prototype.slice.call(o,1)))}),void 0!==l?l:this}},s.registered=!1});