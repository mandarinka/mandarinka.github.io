(function(a,g,h,s){function m(){return"Microsoft Internet Explorer"==navigator.appName||navigator.userAgent.match(/MSIE\s+\d+\.\d+/)||navigator.userAgent.match(/Trident\/\d+\.\d+/)}function q(d,f){a("html, body").each(function(){var b=a(this);k[b.prop("tagName").toLowerCase()]=parseInt(b.css("margin-right"))});var c=a("body"),b=c.outerWidth(!0);c.addClass(d.lockClass);b=c.outerWidth(!0)-b;m()&&(n=c.css("margin-top"),c.css("margin-top",0));a("html").css("margin-right",k.html+b);f.css("left",0-b)}function r(d){a("html, body").each(function(){var f=
a(this);f.css("margin-right",k[f.prop("tagName").toLowerCase()]).removeClass(d.lockClass)});m()&&a("body").css("margin-top",n)}function p(d,f){d.length?d.each(function(){a(this).data("the-modal.options",f)}):a.extend(l,f);a(g).bind("keydown",function(c){if(!c.ctrlKey||65!=c.keyCode)return!0;var b=new a.Event("onSelectAll");b.parentEvent=c;a(g).trigger(b);return!0});d.bind("keydown",function(c){var b=a(":focusable",a(this));b.filter(":last").is(":focus")&&9==(c.which||c.keyCode)&&(c.preventDefault(),
b.filter(":first").focus())});return{open:function(c){var b=d.get(0),e=a.extend({},l,a(b).data("the-modal.options"),c);a("."+e.overlayClass).length&&a.modal().close();c=a("<div/>").addClass(e.overlayClass).prependTo("body");c.data("the-modal.options",e);q(e,c);if(b){var f=null;e.cloning?f=a(b).clone(!0).appendTo(c).show():(c.data("the-modal.el",b),a(b).data("the-modal.parent",a(b).parent()),f=a(b).appendTo(c).show())}e.closeOnEsc&&a(h).bind("keyup.the-modal",function(b){27===b.keyCode&&a.modal().close()});
e.closeOnOverlayClick&&(c.children().on("click.the-modal",function(a){a.stopPropagation()}),a("."+e.overlayClass).on("click.the-modal",function(b){a.modal().close()}));a(h).bind("touchmove.the-modal",function(b){a(b).parents("."+e.overlayClass)||b.preventDefault()});b&&a(g).bind("onSelectAll",function(a){a.parentEvent.preventDefault();var b=a=null,c=f.get(0);h.body.createTextRange?(a=h.body.createTextRange(),a.moveToElementText(c),a.select()):g.getSelection&&(b=g.getSelection(),a=h.createRange(),
a.selectNodeContents(c),b.removeAllRanges(),b.addRange(a))});if(e.onOpen)e.onOpen(c,e)},close:function(){var c=d.get(0),b=a.extend({},l,f),e=a("."+b.overlayClass);a.extend(b,e.data("the-modal.options"));if(!a.isFunction(b.onBeforeClose)||!1!==b.onBeforeClose(e,b))if(b.cloning||(c||(c=e.data("the-modal.el")),a(c).hide().appendTo(a(c).data("the-modal.parent"))),e.remove(),r(b),b.closeOnEsc&&a(h).unbind("keyup.the-modal"),a(g).unbind("onSelectAll"),b.onClose)b.onClose(e,b)}}}a.extend(a.expr[":"],{focusable:function(d){function f(b){return a.expr.filters.visible(b)&&
!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var c,b;c=d.nodeName.toLowerCase();b=!isNaN(a.attr(d,"tabindex"));if("area"===c){c=d.parentNode;b=c.name;if(!d.href||!b||"map"!==c.nodeName.toLowerCase())return!1;d=a("img[usemap=#"+b+"]")[0];return!!d&&f(d)}var e=b;/input|select|textarea|button|object/.test(c)?e=!d.disabled:"a"===c&&(e=d.href||b);return e&&f(d)}});var l={lockClass:"themodal-lock",overlayClass:"themodal-overlay",closeOnEsc:!0,closeOnOverlayClick:!0,
onBeforeClose:null,onClose:null,onOpen:null,cloning:!0},k={},n=0;a.modal=function(d){return p(a(),d)};a.fn.modal=function(a){return p(this,a)}})(jQuery,window,document);